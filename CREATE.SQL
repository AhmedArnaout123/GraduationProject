
CREATE TABLE Categories
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  Name VARCHAR(200) NOT NULL,
  ParentId UNIQUEIDENTIFIER NULL FOREIGN KEY REFERENCES Categories(Id)
);

CREATE TABLE Discounts
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  Percentage INT NOT NULL,
  Description VARCHAR(MAX) NOT NULL
);

CREATE TABLE Products
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  Name VARCHAR(400) NOT NULL,
  Description VARCHAR(MAX) NOT NULL,
  MainImageUri VARCHAR(400) NOT NULL,
  Price REAL NOT NULL,
  CategoryId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Categories(Id),
  DiscountId  UNIQUEIDENTIFIER NULL FOREIGN KEY REFERENCES Discounts(Id),
  RatesSum INT NOT NULL DEFAULT 0
);

CREATE TABLE ProductImages
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  Uri VARCHAR(200),
  ProductId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Products(Id)
);

CREATE TABLE Customers
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  FirstName VARCHAR(200) NOT NULL,
  LastName VARCHAR(200) NOT NULL,
  PhoneNumber VARCHAR(200) NOT NULL,
  Email VARCHAR(200) NOT NULL,
  Password VARCHAR(MAX) NOT NULL
)

CREATE TABLE Reviews
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  Rate INT NOT NULL,
  Comment VARCHAR(MAX) NOT NULL,
  Date DATETIME NOT NULL,
  CustomerId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Customers(Id),
  ProductId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Products(Id)
)

CREATE TABLE Addresses
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  Country VARCHAR(200) NOT NULL,
  State VARCHAR(200) NOT NULL,
  City VARCHAR(200) NOT NULL,
  Street1 VARCHAR(200) NOT NULL,
  Street2 VARCHAR(200) NOT NULL,
  CustomerId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Customers(Id)
)

CREATE TABLE Products_WishLists
(
  CustomerId UNIQUEIDENTIFIER NOT NULL,
  ProductId UNIQUEIDENTIFIER NOT NULL,
  PRIMARY KEY (CustomerId, ProductId)
)

CREATE TABLE Products_ShoppingCarts
(
  CustomerId UNIQUEIDENTIFIER NOT NULL,
  ProductId UNIQUEIDENTIFIER NOT NULL,
  Quantity INT NOT NULL
  PRIMARY KEY (CustomerId, ProductId)
)

CREATE TABLE Orders
(
  Id UNIQUEIDENTIFIER PRIMARY KEY,
  Date Date NOT NULL,
  Status VARCHAR(MAX) NOT NULL,
  CustomerId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Customers(Id),
  AddressId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Addresses(Id)
)

CREATE TABLE Orders_Products
(
  ProductName VARCHAR(200) NOT NULL,
  ProductPrice REAL NOT NULL,
  Quantity INT NOT NULL,
  OrderId UNIQUEIDENTIFIER NOT NULL,
  ProductId UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES Products(Id),
  DiscountId UNIQUEIDENTIFIER NULL FOREIGN KEY REFERENCES Discounts(Id)
  PRIMARY KEY (OrderId, ProductId)
)